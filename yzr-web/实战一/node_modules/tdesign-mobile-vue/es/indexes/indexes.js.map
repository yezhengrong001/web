{"version":3,"file":"indexes.js","sources":["../../src/indexes/indexes.vue","../../src/indexes/indexes.vue?vue&type=template&id=1bfe4616&lang.js"],"sourcesContent":["<template>\n  <div ref=\"indexesRoot\" :style=\"indexesRootStyle\" :class=\"componentName\" @scroll=\"handleRootScroll\">\n    <div\n      v-if=\"list.length > 0\"\n      :class=\"`${componentName}__sidebar`\"\n      @touchstart=\"handleSidebarTouchstart\"\n      @touchmove=\"handleSidebarTouchmove\"\n    >\n      <div\n        v-for=\"item in list\"\n        :key=\"item.index\"\n        :class=\"[\n          `${componentName}__sidebar-item`,\n          activeSidebar === item.index ? `${componentName}__sidebar-item--active` : '',\n        ]\"\n        :data-index=\"item.index\"\n        @click.prevent=\"handleSidebarItemClick(item.index)\"\n      >\n        {{ item.index }}\n        <div v-if=\"showSidebarTip && activeSidebar === item.index\" :class=\"`${componentName}__sidebar-tip`\">\n          <span :class=\"`${componentName}__sidebar-tip-text`\">\n            {{ activeSidebar }}\n          </span>\n        </div>\n      </div>\n    </div>\n\n    <div v-for=\"(item, index) in list\" :ref=\"setAnchorGroupRefs(index)\" :key=\"item.index\" :data-index=\"item.index\">\n      <indexes-anchor :ref=\"setAnchorRefs(index)\" :anchor-style=\"anchorStyle[index]\">\n        {{ item.title ?? item.index }}\n      </indexes-anchor>\n      <div :class=\"[`${componentName}__group`]\">\n        <t-indexes-cell\n          v-for=\"(child, childrenIndex) in item.children\"\n          :key=\"child.title\"\n          :value=\"String(child.title)\"\n          :title=\"child.title\"\n          :link=\"true\"\n          :bordered=\"false\"\n          @click=\"handleCellClick({ groupIndex: item.index, childrenIndex: childrenIndex })\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {\n  ref,\n  reactive,\n  defineComponent,\n  PropType,\n  onMounted,\n  watchEffect,\n  computed,\n  onBeforeUnmount,\n  toRefs,\n  SetupContext,\n} from 'vue';\nimport config from '../config';\nimport { ListItem } from './type';\nimport IndexesProps from './props';\nimport { useEmitEvent } from '../shared';\nimport indexesAnchor from './indexes-anchor.vue';\n\nconst { prefix } = config;\n\ninterface Touch {\n  startX: number;\n  startY: number;\n  deltaX: number;\n  deltaY: number;\n  offsetX: number;\n  offsetY: number;\n}\ninterface State {\n  componentName: string;\n  list: ListItem[];\n  showSidebarTip: boolean;\n  activeSidebar: string;\n  activeIndex: number;\n}\n\nconst touch: Touch = {\n  startX: 0,\n  startY: 0,\n  deltaX: 0,\n  deltaY: 0,\n  offsetX: 0,\n  offsetY: 0,\n};\n\nconst componentName = `${prefix}-indexes`;\n\nexport default defineComponent({\n  name: componentName,\n  components: { indexesAnchor },\n  props: IndexesProps,\n  emits: ['select'],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    let timeOut: number;\n    const indexesRoot = ref<null | HTMLElement>(null);\n    const state: State = reactive({\n      componentName,\n      list: props.list,\n      showSidebarTip: false,\n      activeSidebar: '',\n      activeIndex: -1,\n    });\n\n    const anchorGroup = ref<HTMLElement[]>([]);\n    const setAnchorGroupRefs = (index: number) => {\n      return (el: any) => {\n        anchorGroup.value[index] = el as HTMLElement;\n      };\n    };\n\n    const anchor = ref<any[]>([]);\n    const anchorStyle = reactive<string[]>([]);\n    const setAnchorRefs = (index: number) => {\n      return (el: any) => {\n        anchor.value[index] = el as HTMLElement;\n      };\n    };\n\n    const indexesRootStyle = computed(() => {\n      if (typeof props.height !== 'number') {\n        return {};\n      }\n      const height = Number(props.height);\n      return { height: height === 0 ? 0 : `${height}px` };\n    });\n\n    const scrollToView = (): void => {\n      const children = anchorGroup.value;\n      const targets = children.filter((ele) => {\n        const { dataset } = ele;\n        return dataset && dataset.index === state.activeSidebar;\n      });\n      targets[0]?.scrollIntoView();\n    };\n\n    const calcSticky = (indexesRootTop: number) => {\n      const children = anchorGroup.value;\n      for (let i = 0; i < children.length; i++) {\n        const { top: childTop, width } = children[i].getBoundingClientRect();\n        anchorStyle[i] = `z-index: ${i + 1};`;\n        if (childTop < indexesRootTop && i === state.activeIndex) {\n          anchorStyle[i] += `position:fixed;top:${indexesRootTop}px;width: ${width}px;`;\n        } else {\n          anchorStyle[i] += '';\n        }\n        const anchorHeight = anchor.value[i - 1]?.$el.getBoundingClientRect()?.height;\n        const diff = childTop - indexesRootTop - anchorHeight;\n        if (i - 1 === state.activeIndex && diff < 0) {\n          anchorStyle[i - 1] += `transform: translateY(${diff}px)`;\n        }\n      }\n    };\n\n    const calcChildPosition = (scrollTop: number) => {\n      const children = anchorGroup.value;\n      let currentIndex = -1;\n      for (let i = 0; i < children.length - 1; i++) {\n        if (scrollTop < children[i + 1].offsetTop) {\n          currentIndex = i;\n          break;\n        }\n      }\n      if (scrollTop >= children[children.length - 1].offsetTop) {\n        currentIndex = children.length - 1;\n      }\n      state.activeIndex = currentIndex;\n      state.activeSidebar = children[currentIndex].dataset.index ?? '';\n    };\n\n    const setActiveSidebarAndTip = (index: string) => {\n      state.activeSidebar = index;\n      state.showSidebarTip = true;\n    };\n\n    watchEffect(() => {\n      if (state.showSidebarTip) {\n        clearSidebarTip();\n      }\n    });\n\n    const handleSidebarItemClick = (index: string) => {\n      setActiveSidebarAndTip(index);\n      scrollToView();\n    };\n\n    const handleSidebarTouchstart = (event: TouchEvent): void => {\n      event.stopPropagation();\n      const { touches } = event;\n      touch.startX = touches[0].clientX;\n      touch.startY = touches[0].clientX;\n    };\n\n    const handleSidebarTouchmove = (event: TouchEvent): void => {\n      event.preventDefault();\n      const { touches } = event;\n      const { clientX, clientY } = touches[0];\n\n      const target = document.elementFromPoint(clientX, clientY);\n      if (target && target.className === `${componentName}__sidebar-item` && target instanceof HTMLElement) {\n        const { index } = target.dataset;\n        if (index !== undefined && state.activeSidebar !== index) {\n          setActiveSidebarAndTip(index);\n          scrollToView();\n        }\n      }\n    };\n\n    const handleRootScroll = (event: UIEvent) => {\n      if (indexesRoot.value) {\n        calcChildPosition(indexesRoot.value.scrollTop);\n        if (props.sticky) {\n          const indexesRootTop = indexesRoot.value?.getBoundingClientRect()?.top ?? 0;\n          calcSticky(indexesRootTop);\n        }\n      }\n    };\n\n    const clearSidebarTip = (): void => {\n      if (state.showSidebarTip && state.activeSidebar) {\n        timeOut && clearTimeout(timeOut);\n        timeOut = window.setTimeout(() => {\n          state.showSidebarTip = false;\n        }, 1000);\n      }\n    };\n\n    const handleCellClick = (indexes: { groupIndex: string; childrenIndex: number }) => {\n      emitEvent('select', indexes);\n    };\n\n    onMounted(() => {\n      const children = anchorGroup.value;\n      if (children.length > 0) {\n        const { index } = children[0].dataset;\n        if (index !== undefined) {\n          state.activeSidebar = index;\n        }\n      }\n    });\n    onBeforeUnmount(() => {\n      timeOut && clearTimeout(timeOut);\n    });\n\n    return {\n      ...toRefs(state),\n      indexesRoot,\n      indexesRootStyle,\n      anchorGroup,\n      anchorStyle,\n      setAnchorGroupRefs,\n      setAnchorRefs,\n      handleSidebarItemClick,\n      handleSidebarTouchmove,\n      handleSidebarTouchstart,\n      handleRootScroll,\n      handleCellClick,\n    };\n  },\n});\n</script>\n","<template>\n  <div ref=\"indexesRoot\" :style=\"indexesRootStyle\" :class=\"componentName\" @scroll=\"handleRootScroll\">\n    <div\n      v-if=\"list.length > 0\"\n      :class=\"`${componentName}__sidebar`\"\n      @touchstart=\"handleSidebarTouchstart\"\n      @touchmove=\"handleSidebarTouchmove\"\n    >\n      <div\n        v-for=\"item in list\"\n        :key=\"item.index\"\n        :class=\"[\n          `${componentName}__sidebar-item`,\n          activeSidebar === item.index ? `${componentName}__sidebar-item--active` : '',\n        ]\"\n        :data-index=\"item.index\"\n        @click.prevent=\"handleSidebarItemClick(item.index)\"\n      >\n        {{ item.index }}\n        <div v-if=\"showSidebarTip && activeSidebar === item.index\" :class=\"`${componentName}__sidebar-tip`\">\n          <span :class=\"`${componentName}__sidebar-tip-text`\">\n            {{ activeSidebar }}\n          </span>\n        </div>\n      </div>\n    </div>\n\n    <div v-for=\"(item, index) in list\" :ref=\"setAnchorGroupRefs(index)\" :key=\"item.index\" :data-index=\"item.index\">\n      <indexes-anchor :ref=\"setAnchorRefs(index)\" :anchor-style=\"anchorStyle[index]\">\n        {{ item.title ?? item.index }}\n      </indexes-anchor>\n      <div :class=\"[`${componentName}__group`]\">\n        <t-indexes-cell\n          v-for=\"(child, childrenIndex) in item.children\"\n          :key=\"child.title\"\n          :value=\"String(child.title)\"\n          :title=\"child.title\"\n          :link=\"true\"\n          :bordered=\"false\"\n          @click=\"handleCellClick({ groupIndex: item.index, childrenIndex: childrenIndex })\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {\n  ref,\n  reactive,\n  defineComponent,\n  PropType,\n  onMounted,\n  watchEffect,\n  computed,\n  onBeforeUnmount,\n  toRefs,\n  SetupContext,\n} from 'vue';\nimport config from '../config';\nimport { ListItem } from './type';\nimport IndexesProps from './props';\nimport { useEmitEvent } from '../shared';\nimport indexesAnchor from './indexes-anchor.vue';\n\nconst { prefix } = config;\n\ninterface Touch {\n  startX: number;\n  startY: number;\n  deltaX: number;\n  deltaY: number;\n  offsetX: number;\n  offsetY: number;\n}\ninterface State {\n  componentName: string;\n  list: ListItem[];\n  showSidebarTip: boolean;\n  activeSidebar: string;\n  activeIndex: number;\n}\n\nconst touch: Touch = {\n  startX: 0,\n  startY: 0,\n  deltaX: 0,\n  deltaY: 0,\n  offsetX: 0,\n  offsetY: 0,\n};\n\nconst componentName = `${prefix}-indexes`;\n\nexport default defineComponent({\n  name: componentName,\n  components: { indexesAnchor },\n  props: IndexesProps,\n  emits: ['select'],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    let timeOut: number;\n    const indexesRoot = ref<null | HTMLElement>(null);\n    const state: State = reactive({\n      componentName,\n      list: props.list,\n      showSidebarTip: false,\n      activeSidebar: '',\n      activeIndex: -1,\n    });\n\n    const anchorGroup = ref<HTMLElement[]>([]);\n    const setAnchorGroupRefs = (index: number) => {\n      return (el: any) => {\n        anchorGroup.value[index] = el as HTMLElement;\n      };\n    };\n\n    const anchor = ref<any[]>([]);\n    const anchorStyle = reactive<string[]>([]);\n    const setAnchorRefs = (index: number) => {\n      return (el: any) => {\n        anchor.value[index] = el as HTMLElement;\n      };\n    };\n\n    const indexesRootStyle = computed(() => {\n      if (typeof props.height !== 'number') {\n        return {};\n      }\n      const height = Number(props.height);\n      return { height: height === 0 ? 0 : `${height}px` };\n    });\n\n    const scrollToView = (): void => {\n      const children = anchorGroup.value;\n      const targets = children.filter((ele) => {\n        const { dataset } = ele;\n        return dataset && dataset.index === state.activeSidebar;\n      });\n      targets[0]?.scrollIntoView();\n    };\n\n    const calcSticky = (indexesRootTop: number) => {\n      const children = anchorGroup.value;\n      for (let i = 0; i < children.length; i++) {\n        const { top: childTop, width } = children[i].getBoundingClientRect();\n        anchorStyle[i] = `z-index: ${i + 1};`;\n        if (childTop < indexesRootTop && i === state.activeIndex) {\n          anchorStyle[i] += `position:fixed;top:${indexesRootTop}px;width: ${width}px;`;\n        } else {\n          anchorStyle[i] += '';\n        }\n        const anchorHeight = anchor.value[i - 1]?.$el.getBoundingClientRect()?.height;\n        const diff = childTop - indexesRootTop - anchorHeight;\n        if (i - 1 === state.activeIndex && diff < 0) {\n          anchorStyle[i - 1] += `transform: translateY(${diff}px)`;\n        }\n      }\n    };\n\n    const calcChildPosition = (scrollTop: number) => {\n      const children = anchorGroup.value;\n      let currentIndex = -1;\n      for (let i = 0; i < children.length - 1; i++) {\n        if (scrollTop < children[i + 1].offsetTop) {\n          currentIndex = i;\n          break;\n        }\n      }\n      if (scrollTop >= children[children.length - 1].offsetTop) {\n        currentIndex = children.length - 1;\n      }\n      state.activeIndex = currentIndex;\n      state.activeSidebar = children[currentIndex].dataset.index ?? '';\n    };\n\n    const setActiveSidebarAndTip = (index: string) => {\n      state.activeSidebar = index;\n      state.showSidebarTip = true;\n    };\n\n    watchEffect(() => {\n      if (state.showSidebarTip) {\n        clearSidebarTip();\n      }\n    });\n\n    const handleSidebarItemClick = (index: string) => {\n      setActiveSidebarAndTip(index);\n      scrollToView();\n    };\n\n    const handleSidebarTouchstart = (event: TouchEvent): void => {\n      event.stopPropagation();\n      const { touches } = event;\n      touch.startX = touches[0].clientX;\n      touch.startY = touches[0].clientX;\n    };\n\n    const handleSidebarTouchmove = (event: TouchEvent): void => {\n      event.preventDefault();\n      const { touches } = event;\n      const { clientX, clientY } = touches[0];\n\n      const target = document.elementFromPoint(clientX, clientY);\n      if (target && target.className === `${componentName}__sidebar-item` && target instanceof HTMLElement) {\n        const { index } = target.dataset;\n        if (index !== undefined && state.activeSidebar !== index) {\n          setActiveSidebarAndTip(index);\n          scrollToView();\n        }\n      }\n    };\n\n    const handleRootScroll = (event: UIEvent) => {\n      if (indexesRoot.value) {\n        calcChildPosition(indexesRoot.value.scrollTop);\n        if (props.sticky) {\n          const indexesRootTop = indexesRoot.value?.getBoundingClientRect()?.top ?? 0;\n          calcSticky(indexesRootTop);\n        }\n      }\n    };\n\n    const clearSidebarTip = (): void => {\n      if (state.showSidebarTip && state.activeSidebar) {\n        timeOut && clearTimeout(timeOut);\n        timeOut = window.setTimeout(() => {\n          state.showSidebarTip = false;\n        }, 1000);\n      }\n    };\n\n    const handleCellClick = (indexes: { groupIndex: string; childrenIndex: number }) => {\n      emitEvent('select', indexes);\n    };\n\n    onMounted(() => {\n      const children = anchorGroup.value;\n      if (children.length > 0) {\n        const { index } = children[0].dataset;\n        if (index !== undefined) {\n          state.activeSidebar = index;\n        }\n      }\n    });\n    onBeforeUnmount(() => {\n      timeOut && clearTimeout(timeOut);\n    });\n\n    return {\n      ...toRefs(state),\n      indexesRoot,\n      indexesRootStyle,\n      anchorGroup,\n      anchorStyle,\n      setAnchorGroupRefs,\n      setAnchorRefs,\n      handleSidebarItemClick,\n      handleSidebarTouchmove,\n      handleSidebarTouchstart,\n      handleRootScroll,\n      handleCellClick,\n    };\n  },\n});\n</script>\n"],"names":["prefix","config","touch","startX","startY","deltaX","deltaY","offsetX","offsetY","componentName","defineComponent","name","components","indexesAnchor","props","IndexesProps","emits","setup","context","emitEvent","useEmitEvent","emit","timeOut","indexesRoot","ref","state","reactive","list","showSidebarTip","activeSidebar","activeIndex","anchorGroup","setAnchorGroupRefs","index","el","value","anchor","anchorStyle","setAnchorRefs","indexesRootStyle","computed","height","Number","scrollToView","children","targets","filter","ele","dataset","scrollIntoView","calcSticky","indexesRootTop","i","length","getBoundingClientRect","childTop","top","width","anchorHeight","$el","diff","calcChildPosition","scrollTop","currentIndex","offsetTop","setActiveSidebarAndTip","watchEffect","clearSidebarTip","handleSidebarItemClick","handleSidebarTouchstart","event","stopPropagation","touches","clientX","handleSidebarTouchmove","preventDefault","clientY","target","document","elementFromPoint","className","HTMLElement","handleRootScroll","sticky","clearTimeout","window","setTimeout","handleCellClick","indexes","onMounted","onBeforeUnmount","toRefs","_createElementBlock","style","_ctx","class","onScroll","onTouchstart","onTouchmove","_Fragment","_renderList","item","key","_normalizeClass","onClick","_withModifiers","$event","_createElementVNode","_openBlock","_createVNode","_component_indexes_anchor","_createTextVNode","_toDisplayString","title","child","childrenIndex","_createBlock","_component_t_indexes_cell","String","link","bordered","groupIndex"],"mappings":"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"}