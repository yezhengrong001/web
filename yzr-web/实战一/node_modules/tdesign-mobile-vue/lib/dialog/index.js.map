{"version":3,"file":"index.js","sources":["../../src/dialog/index.ts"],"sourcesContent":["import { createApp, defineComponent, h, VNode, App, ref, DefineComponent, nextTick } from 'vue';\n\nimport Dialog from './dialog.vue';\nimport { WithInstallType } from '../shared';\nimport { DialogCloseContext, TdDialogProps } from './type';\n\nimport './style';\n\nexport type DialogType = 'alert' | 'confirm' | 'show';\n\nexport const DialogPropsDefault = {\n  title: '温馨提醒',\n  content: '',\n  type: '',\n  confirmBtn: '确认',\n  cancelBtn: '取消',\n  visible: false,\n  zIndex: 2500,\n  showOverlay: true,\n  width: '320px',\n  closeOnOverlayClick: false,\n};\n\nlet instance: DefineComponent;\n\nfunction create(props: Partial<TdDialogProps> | string): DefineComponent {\n  const visible = ref(false);\n  const root = document.createElement('div');\n  document.body.appendChild(root);\n\n  const propsObject = {\n    ...DialogPropsDefault,\n    ...(typeof props === 'string' ? { content: props } : props),\n  };\n\n  if (instance) {\n    instance.clear();\n    // instance = null;\n  }\n\n  // eslint-disable-next-line vue/one-component-per-file\n  instance = defineComponent({\n    render: (): VNode =>\n      // @ts-ignore\n      h(Dialog, {\n        ...propsObject,\n        visible: visible.value,\n        onConfirm: (context: { e: MouseEvent }) => {\n          if (typeof propsObject.onConfirm === 'function') {\n            propsObject.onConfirm(context);\n          }\n          visible.value = false;\n        },\n        onCancel: (context: { e: MouseEvent }) => {\n          if (typeof propsObject.onCancel === 'function') {\n            propsObject.onCancel(context);\n          }\n          visible.value = false;\n        },\n        onOverlayClick: (context: { e: MouseEvent }) => {\n          if (typeof propsObject.onOverlayClick === 'function') {\n            propsObject.onOverlayClick(context);\n          }\n          visible.value = false;\n        },\n        onClose: (context: DialogCloseContext) => {\n          root.remove();\n          if (typeof propsObject.onClose === 'function') {\n            propsObject.onClose(context);\n          }\n        },\n      }),\n  });\n\n  instance.clear = () => {\n    root.remove();\n  };\n\n  // eslint-disable-next-line vue/one-component-per-file\n  createApp(instance).mount(root);\n\n  nextTick(() => {\n    visible.value = true;\n  });\n\n  return instance;\n}\n\n(['show', 'alert', 'confirm'] as DialogType[]).forEach((type: DialogType): void => {\n  Dialog[type] = (options: Partial<TdDialogProps> | string) => {\n    let props: any = { content: '', type };\n\n    if (typeof options === 'string') {\n      props.content = options;\n    } else {\n      props = { ...props, ...options };\n    }\n\n    return create(props);\n  };\n});\n\nDialog.install = (app: App, name = '') => {\n  app.component(name || Dialog.name, Dialog);\n\n  // 添加插件入口\n  app.config.globalProperties.$dialog = Dialog;\n  app.provide('$dialog', Dialog);\n};\n\ntype DialogApi = {\n  /** 通用对话框 */\n  show: (options: Partial<TdDialogProps> | string) => void;\n  /** 基础对话框 */\n  alert: (options: Partial<TdDialogProps> | string) => void;\n  /** 选择对话框 */\n  confirm: (options: Partial<TdDialogProps> | string) => void;\n};\n\nexport const DialogPlugin: WithInstallType<typeof Dialog> & DialogApi = Dialog as any;\nexport default DialogPlugin;\n\ndeclare module '@vue/runtime-core' {\n  // Bind to `this` keyword\n  export interface ComponentCustomProperties {\n    $dialog: DialogApi;\n  }\n}\n"],"names":["DialogPropsDefault","title","content","type","confirmBtn","cancelBtn","visible","zIndex","showOverlay","width","closeOnOverlayClick","instance","create","props","ref","root","document","createElement","body","appendChild","propsObject","clear","defineComponent","render","h","Dialog","value","onConfirm","context","onCancel","onOverlayClick","onClose","remove","createApp","mount","nextTick","forEach","options","install","app","name","component","config","globalProperties","$dialog","provide","DialogPlugin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUO,IAAMA,kBAAqB,GAAA;AAChCC,EAAAA,KAAO,EAAA,0BAAA;AACPC,EAAAA,OAAS,EAAA,EAAA;AACTC,EAAAA,IAAM,EAAA,EAAA;AACNC,EAAAA,UAAY,EAAA,cAAA;AACZC,EAAAA,SAAW,EAAA,cAAA;AACXC,EAAAA,OAAS,EAAA,KAAA;AACTC,EAAAA,MAAQ,EAAA,IAAA;AACRC,EAAAA,WAAa,EAAA,IAAA;AACbC,EAAAA,KAAO,EAAA,OAAA;AACPC,EAAAA,mBAAqB,EAAA,KAAA;AACvB,EAAA;AAEA,IAAIC,QAAA,CAAA;AAEJ,SAASC,OAAOC,KAAyD,EAAA;AACjE,EAAA,IAAAP,OAAA,GAAUQ,QAAI,KAAK,CAAA,CAAA;AACnB,EAAA,IAAAC,IAAA,GAAOC,QAAS,CAAAC,aAAA,CAAc,KAAK,CAAA,CAAA;AAChCD,EAAAA,QAAA,CAAAE,IAAA,CAAKC,YAAYJ,IAAI,CAAA,CAAA;EAE9B,IAAMK,WAAc,mCACfpB,kBAAA,CAAA,EACC,OAAOa,KAAA,KAAU,WAAW;AAAEX,IAAAA,OAAA,EAASW,KAAAA;GAAU,GAAAA,KAAA,CACvD,CAAA;AAEA,EAAA,IAAIF,QAAU,EAAA;IACZA,QAAA,CAASU,KAAM,EAAA,CAAA;AAEjB,GAAA;EAGAV,QAAA,GAAWW,mBAAgB,CAAA;AACzBC,IAAAA,MAAA,EAAQ,SAAA,MAAA,GAAA;AAAA,MAAA,OAENC,KAAA,CAAEC,wBAAQ,EAAA,aAAA,CAAA,aAAA,CAAA,EAAA,EACLL,WAAA,CAAA,EAAA,EAAA,EAAA;QACHd,SAASA,OAAQ,CAAAoB,KAAA;QACjBC,SAAA,EAAW,SAACC,SAAAA,CAAAA,OAA+B,EAAA;AACrC,UAAA,IAAA,OAAOR,WAAY,CAAAO,SAAA,KAAc,UAAY,EAAA;AAC/CP,YAAAA,WAAA,CAAYO,UAAUC,OAAO,CAAA,CAAA;AAC/B,WAAA;UACAtB,OAAA,CAAQoB,KAAQ,GAAA,KAAA,CAAA;SAClB;QACAG,QAAA,EAAU,SAACD,QAAAA,CAAAA,OAA+B,EAAA;AACpC,UAAA,IAAA,OAAOR,WAAY,CAAAS,QAAA,KAAa,UAAY,EAAA;AAC9CT,YAAAA,WAAA,CAAYS,SAASD,OAAO,CAAA,CAAA;AAC9B,WAAA;UACAtB,OAAA,CAAQoB,KAAQ,GAAA,KAAA,CAAA;SAClB;QACAI,cAAA,EAAgB,SAACF,cAAAA,CAAAA,OAA+B,EAAA;AAC1C,UAAA,IAAA,OAAOR,WAAY,CAAAU,cAAA,KAAmB,UAAY,EAAA;AACpDV,YAAAA,WAAA,CAAYU,eAAeF,OAAO,CAAA,CAAA;AACpC,WAAA;UACAtB,OAAA,CAAQoB,KAAQ,GAAA,KAAA,CAAA;SAClB;QACAK,OAAA,EAAS,SAACH,OAAAA,CAAAA,OAAgC,EAAA;UACxCb,IAAA,CAAKiB,MAAO,EAAA,CAAA;AACR,UAAA,IAAA,OAAOZ,WAAY,CAAAW,OAAA,KAAY,UAAY,EAAA;AAC7CX,YAAAA,WAAA,CAAYW,QAAQH,OAAO,CAAA,CAAA;AAC7B,WAAA;AACF,SAAA;OACD,CAAA,CAAA,CAAA;AAAA,KAAA;AACL,GAAC,CAAA,CAAA;EAEDjB,QAAA,CAASU,QAAQ,YAAM;IACrBN,IAAA,CAAKiB,MAAO,EAAA,CAAA;GACd,CAAA;AAGUC,EAAAA,aAAA,CAAAtB,QAAQ,CAAE,CAAAuB,KAAA,CAAMnB,IAAI,CAAA,CAAA;AAE9BoB,EAAAA,YAAA,CAAS,YAAM;IACb7B,OAAA,CAAQoB,KAAQ,GAAA,IAAA,CAAA;AAClB,GAAC,CAAA,CAAA;AAEM,EAAA,OAAAf,QAAA,CAAA;AACT,CAAA;AAEC,CAAC,QAAQ,OAAS,EAAA,SAAS,CAAmB,CAAAyB,OAAA,CAAQ,UAACjC,IAA2B,EAAA;AAC1EsB,EAAAA,wBAAA,CAAAtB,IAAA,CAAA,GAAQ,UAACkC,OAA6C,EAAA;AAC3D,IAAA,IAAIxB,KAAa,GAAA;AAAEX,MAAAA,OAAS,EAAA,EAAA;AAAIC,MAAAA,IAAK,EAALA,IAAAA;KAAK,CAAA;AAEjC,IAAA,IAAA,OAAOkC,YAAY,QAAU,EAAA;MAC/BxB,KAAA,CAAMX,OAAU,GAAAmC,OAAA,CAAA;AAClB,KAAO,MAAA;AACLxB,MAAAA,KAAA,GAAaA,aAAAA,CAAAA,aAAAA,CAAAA,EAAAA,EAAAA,KAAO,CAAGwB,EAAAA,OAAQ,CAAA,CAAA;AACjC,KAAA;IAEA,OAAOzB,OAAOC,KAAK,CAAA,CAAA;GACrB,CAAA;AACF,CAAC,CAAA,CAAA;AAEDY,wBAAA,CAAOa,OAAU,GAAA,UAACC,GAAU,EAAc;EAAA,IAAdC,IAAA,uEAAO,EAAO,CAAA;EACxCD,GAAA,CAAIE,SAAU,CAAAD,IAAA,IAAQf,wBAAO,CAAAe,IAAA,EAAMf,wBAAM,CAAA,CAAA;AAGrCc,EAAAA,GAAA,CAAAG,MAAA,CAAOC,iBAAiBC,OAAU,GAAAnB,wBAAA,CAAA;AAClCc,EAAAA,GAAA,CAAAM,OAAA,CAAQ,WAAWpB,wBAAM,CAAA,CAAA;AAC/B,CAAA,CAAA;AAWO,IAAMqB,YAA2D,GAAArB;;;;;;"}