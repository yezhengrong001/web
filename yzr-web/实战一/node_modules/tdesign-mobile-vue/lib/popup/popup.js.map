{"version":3,"file":"popup.js","sources":["../../src/popup/popup.vue","../../src/popup/popup.vue?vue&type=template&id=3b5ae3b1&lang.js"],"sourcesContent":["<template>\n  <teleport :to=\"to\" :disabled=\"!to\">\n    <div :class=\"[rootClasses, $attrs.class]\" :style=\"rootStyles\" @touchmove=\"handleMove\">\n      <transition name=\"fade\">\n        <t-overlay\n          v-bind=\"overlayProps\"\n          :visible=\"currentVisible\"\n          :transparent=\"!showOverlay\"\n          @click=\"handleOverlayClick\"\n        />\n      </transition>\n      <transition :name=\"contentTransitionName\" @after-enter=\"afterEnter\" @after-leave=\"afterLeave\">\n        <div v-show=\"currentVisible\" :class=\"contentClasses\">\n          <slot></slot>\n        </div>\n      </transition>\n    </div>\n  </teleport>\n</template>\n\n<script lang=\"ts\">\nimport { ref, computed, SetupContext, watch, defineComponent } from 'vue';\nimport popupProps from './props';\nimport TOverlay from '../overlay';\nimport config from '../config';\nimport { TdPopupProps } from './type';\nimport { useDefault, useEmitEvent } from '../shared';\n\nconst { prefix } = config;\n\nconst name = `${prefix}-popup`;\n\nexport default defineComponent({\n  name,\n  components: { TOverlay },\n  props: popupProps,\n  emits: ['open', 'close', 'opened', 'closed', 'visible-change', 'update:visible', 'update:modelValue'],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    const [currentVisible] = useDefault<TdPopupProps['visible'], TdPopupProps>(\n      props,\n      context.emit,\n      'visible',\n      'visible-change',\n    );\n\n    const rootClasses = computed(() => name);\n    const rootStyles = computed(() =>\n      props.customStyle || props.zIndex\n        ? (props.customStyle && `${props.customStyle};`) + (props.zIndex && `z-index:${props.zIndex};`)\n        : undefined,\n    );\n\n    const contentClasses = computed(() => ({\n      [`${name}--content`]: true,\n      [`${name}--content-${props.placement}`]: true,\n    }));\n\n    const contentTransitionName = computed(() => {\n      const { transitionName, placement } = props;\n      if (transitionName) return transitionName;\n      if (placement === 'center') return 'fade-zoom';\n      return `slide-${placement}`;\n    });\n\n    watch(\n      () => currentVisible.value,\n      (val) => {\n        const cls = `${prefix}-overflow-hidden`;\n        if (val) {\n          document.body.classList.add(cls);\n          emitEvent('open');\n          currentVisible.value = true;\n        } else {\n          document.body.classList.remove(cls);\n        }\n      },\n    );\n\n    const handleOverlayClick = () => {\n      if (!props.closeOnOverlayClick) {\n        return;\n      }\n      emitEvent('close');\n      currentVisible.value = false;\n    };\n\n    const handleMove = (e: TouchEvent) => {\n      if (props.lockScroll) {\n        e.preventDefault();\n      }\n    };\n\n    const afterLeave = () => emitEvent('closed');\n    const afterEnter = () => emitEvent('opened');\n\n    return {\n      name: ref(name),\n      currentVisible,\n      rootClasses,\n      rootStyles,\n      contentClasses,\n      contentTransitionName,\n      afterEnter,\n      afterLeave,\n      handleOverlayClick,\n      handleMove,\n    };\n  },\n});\n</script>\n","<template>\n  <teleport :to=\"to\" :disabled=\"!to\">\n    <div :class=\"[rootClasses, $attrs.class]\" :style=\"rootStyles\" @touchmove=\"handleMove\">\n      <transition name=\"fade\">\n        <t-overlay\n          v-bind=\"overlayProps\"\n          :visible=\"currentVisible\"\n          :transparent=\"!showOverlay\"\n          @click=\"handleOverlayClick\"\n        />\n      </transition>\n      <transition :name=\"contentTransitionName\" @after-enter=\"afterEnter\" @after-leave=\"afterLeave\">\n        <div v-show=\"currentVisible\" :class=\"contentClasses\">\n          <slot></slot>\n        </div>\n      </transition>\n    </div>\n  </teleport>\n</template>\n\n<script lang=\"ts\">\nimport { ref, computed, SetupContext, watch, defineComponent } from 'vue';\nimport popupProps from './props';\nimport TOverlay from '../overlay';\nimport config from '../config';\nimport { TdPopupProps } from './type';\nimport { useDefault, useEmitEvent } from '../shared';\n\nconst { prefix } = config;\n\nconst name = `${prefix}-popup`;\n\nexport default defineComponent({\n  name,\n  components: { TOverlay },\n  props: popupProps,\n  emits: ['open', 'close', 'opened', 'closed', 'visible-change', 'update:visible', 'update:modelValue'],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    const [currentVisible] = useDefault<TdPopupProps['visible'], TdPopupProps>(\n      props,\n      context.emit,\n      'visible',\n      'visible-change',\n    );\n\n    const rootClasses = computed(() => name);\n    const rootStyles = computed(() =>\n      props.customStyle || props.zIndex\n        ? (props.customStyle && `${props.customStyle};`) + (props.zIndex && `z-index:${props.zIndex};`)\n        : undefined,\n    );\n\n    const contentClasses = computed(() => ({\n      [`${name}--content`]: true,\n      [`${name}--content-${props.placement}`]: true,\n    }));\n\n    const contentTransitionName = computed(() => {\n      const { transitionName, placement } = props;\n      if (transitionName) return transitionName;\n      if (placement === 'center') return 'fade-zoom';\n      return `slide-${placement}`;\n    });\n\n    watch(\n      () => currentVisible.value,\n      (val) => {\n        const cls = `${prefix}-overflow-hidden`;\n        if (val) {\n          document.body.classList.add(cls);\n          emitEvent('open');\n          currentVisible.value = true;\n        } else {\n          document.body.classList.remove(cls);\n        }\n      },\n    );\n\n    const handleOverlayClick = () => {\n      if (!props.closeOnOverlayClick) {\n        return;\n      }\n      emitEvent('close');\n      currentVisible.value = false;\n    };\n\n    const handleMove = (e: TouchEvent) => {\n      if (props.lockScroll) {\n        e.preventDefault();\n      }\n    };\n\n    const afterLeave = () => emitEvent('closed');\n    const afterEnter = () => emitEvent('opened');\n\n    return {\n      name: ref(name),\n      currentVisible,\n      rootClasses,\n      rootStyles,\n      contentClasses,\n      contentTransitionName,\n      afterEnter,\n      afterLeave,\n      handleOverlayClick,\n      handleMove,\n    };\n  },\n});\n</script>\n"],"names":["prefix","config","name","defineComponent","components","TOverlay","props","popupProps","emits","setup","context","emitEvent","useEmitEvent","emit","useDefault","_slicedToArray","currentVisible","rootClasses","computed","rootStyles","customStyle","zIndex","contentClasses","placement","contentTransitionName","transitionName","watch","value","val","cls","document","body","classList","add","remove","handleOverlayClick","closeOnOverlayClick","handleMove","e","lockScroll","preventDefault","afterLeave","afterEnter","ref","_createBlock","_Teleport","to","_ctx","disabled","_createElementVNode","class","_normalizeClass","$attrs","style","onTouchmove","_createVNode","_Transition","_component_t_overlay","_mergeProps","overlayProps","visible","transparent","showOverlay","onClick","onAfterEnter","onAfterLeave","_renderSlot","$slots"],"mappings":"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"}