{"version":3,"file":"list.js","sources":["../../src/list/list.vue","../../src/list/list.vue?vue&type=template&id=0d9a4418&lang.js"],"sourcesContent":["<template>\n  <div ref=\"root\" :class=\"name\" @scroll=\"handleScroll\">\n    <t-node :content=\"headerContent\" />\n    <slot />\n    <div @click.stop=\"onLoadMore\">\n      <t-loading\n        v-if=\"typeof asyncLoading === 'string' && ['loading', 'load-more'].includes(asyncLoading)\"\n        :loading=\"asyncLoading === 'loading'\"\n        :text=\"typeof asyncLoading === 'string' ? LOADING_TEXT_MAP[asyncLoading] : ''\"\n        :class=\"`${name}__loading`\"\n      />\n    </div>\n    <t-node :content=\"footerContent\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, computed, getCurrentInstance, SetupContext } from 'vue';\nimport { useElementBounding, useWindowSize, useEventListener } from '@vueuse/core';\nimport TLoading from '../loading';\nimport config from '../config';\nimport ListProps from './props';\nimport { renderTNode, TNode, useScrollParent, useEmitEvent } from '../shared';\n\nconst { prefix } = config;\nconst name = `${prefix}-list`;\nconst LOADING_TEXT_MAP = {\n  loading: '加载中...',\n  'load-more': '点击加载更多',\n};\n\nexport default defineComponent({\n  name,\n  components: {\n    TLoading,\n    TNode,\n  },\n  props: ListProps,\n  emits: ['load-more', 'scroll'],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    const root = ref<HTMLElement>();\n    const empty = ref<HTMLElement>();\n    const scrollParent = useScrollParent(root);\n    const { height } = useWindowSize();\n    const internalInstance = getCurrentInstance();\n\n    const headerContent = computed(() => renderTNode(internalInstance, 'header'));\n    const footerContent = computed(() => renderTNode(internalInstance, 'footer'));\n\n    const onLoadMore = (e: MouseEvent) => {\n      if (props.asyncLoading === 'load-more') {\n        emitEvent('load-more');\n      }\n    };\n\n    const handleScroll = (e: WheelEvent | Event) => {\n      const { bottom } = useElementBounding(root);\n      emitEvent('scroll', bottom.value - height.value);\n    };\n\n    useEventListener(scrollParent, 'scroll', handleScroll);\n\n    return {\n      name,\n      root,\n      empty,\n      onLoadMore,\n      handleScroll,\n      headerContent,\n      footerContent,\n      LOADING_TEXT_MAP,\n    };\n  },\n});\n</script>\n","<template>\n  <div ref=\"root\" :class=\"name\" @scroll=\"handleScroll\">\n    <t-node :content=\"headerContent\" />\n    <slot />\n    <div @click.stop=\"onLoadMore\">\n      <t-loading\n        v-if=\"typeof asyncLoading === 'string' && ['loading', 'load-more'].includes(asyncLoading)\"\n        :loading=\"asyncLoading === 'loading'\"\n        :text=\"typeof asyncLoading === 'string' ? LOADING_TEXT_MAP[asyncLoading] : ''\"\n        :class=\"`${name}__loading`\"\n      />\n    </div>\n    <t-node :content=\"footerContent\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, computed, getCurrentInstance, SetupContext } from 'vue';\nimport { useElementBounding, useWindowSize, useEventListener } from '@vueuse/core';\nimport TLoading from '../loading';\nimport config from '../config';\nimport ListProps from './props';\nimport { renderTNode, TNode, useScrollParent, useEmitEvent } from '../shared';\n\nconst { prefix } = config;\nconst name = `${prefix}-list`;\nconst LOADING_TEXT_MAP = {\n  loading: '加载中...',\n  'load-more': '点击加载更多',\n};\n\nexport default defineComponent({\n  name,\n  components: {\n    TLoading,\n    TNode,\n  },\n  props: ListProps,\n  emits: ['load-more', 'scroll'],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    const root = ref<HTMLElement>();\n    const empty = ref<HTMLElement>();\n    const scrollParent = useScrollParent(root);\n    const { height } = useWindowSize();\n    const internalInstance = getCurrentInstance();\n\n    const headerContent = computed(() => renderTNode(internalInstance, 'header'));\n    const footerContent = computed(() => renderTNode(internalInstance, 'footer'));\n\n    const onLoadMore = (e: MouseEvent) => {\n      if (props.asyncLoading === 'load-more') {\n        emitEvent('load-more');\n      }\n    };\n\n    const handleScroll = (e: WheelEvent | Event) => {\n      const { bottom } = useElementBounding(root);\n      emitEvent('scroll', bottom.value - height.value);\n    };\n\n    useEventListener(scrollParent, 'scroll', handleScroll);\n\n    return {\n      name,\n      root,\n      empty,\n      onLoadMore,\n      handleScroll,\n      headerContent,\n      footerContent,\n      LOADING_TEXT_MAP,\n    };\n  },\n});\n</script>\n"],"names":["prefix","config","name","LOADING_TEXT_MAP","loading","defineComponent","components","TLoading","TNode","props","ListProps","emits","setup","context","emitEvent","useEmitEvent","emit","root","ref","empty","scrollParent","useScrollParent","useWindowSize","height","internalInstance","getCurrentInstance","headerContent","computed","renderTNode","footerContent","onLoadMore","e","asyncLoading","handleScroll","useElementBounding","bottom","value","useEventListener","_createElementBlock","class","_ctx","onScroll","_createVNode","_component_t_node","content","_renderSlot","$slots","_createElementVNode","onClick","includes","_createBlock","_component_t_loading","text"],"mappings":"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"}