{"version":3,"file":"dropdown-item.js","sources":["../../src/dropdown-menu/dropdown-item.vue","../../src/dropdown-menu/dropdown-item.vue?vue&type=template&id=e0d03006&lang.js"],"sourcesContent":["<template>\n  <div v-if=\"isShowItems\" :class=\"classes\" :style=\"{ ...expandStyle }\">\n    <!-- <t-overlay v-if=\"isShowItems && showOverlay\" @click=\"onClickOverlay\" /> -->\n    <div :class=\"styleContent\" :style=\"{ ...transitionStyle }\">\n      <div :class=\"`${name}__bd`\">\n        <slot>\n          <template v-if=\"optionsLayout === 'columns'\">\n            <template v-if=\"!multiple\">\n              <!-- 单选列表 -->\n              <t-radio-group v-model=\"radioSelect\">\n                <template v-for=\"option in options\" :key=\"option.value\">\n                  <t-radio\n                    :value=\"option.value\"\n                    :label=\"option.title\"\n                    :disabled=\"option.disabled\"\n                    :class=\"styleDropRadio(option.value)\"\n                    align=\"right\"\n                    :checked=\"isCheckedRadio(option.value)\"\n                    :icon=\"renderCheckIcon\"\n                  />\n                </template>\n              </t-radio-group>\n            </template>\n            <template v-else>\n              <!-- 多选列表 -->\n              <t-checkbox-group v-model=\"checkSelect\">\n                <template v-for=\"option in options\" :key=\"option.value\">\n                  <t-checkbox borderless :value=\"option.value\" :label=\"option.title\" :disabled=\"option.disabled\" />\n                </template>\n              </t-checkbox-group>\n            </template>\n          </template>\n          <template v-else-if=\"optionsLayout === 'tree'\">\n            <!-- 树形列表 ST -->\n            <div v-for=\"(_, level) in treeOptions\" :key=\"level\" :class=\"`${name}__tree-group`\">\n              <t-radio-group\n                v-if=\"level < treeState.leafLevel\"\n                :model-value=\"convertTreeRadioType(treeState.selectList[level])\"\n                @update:model-value=\"selectTreeNode(level, $event)\"\n              >\n                <!-- 树形列表 - 父级节点 ST -->\n                <template v-for=\"option in treeOptions[level]\" :key=\"option.value\">\n                  <t-radio\n                    :class=\"styleTreeRadio(option.value, level)\"\n                    :value=\"option.value\"\n                    :label=\"option.title\"\n                    :disabled=\"option.disabled\"\n                    align=\"right\"\n                    :icon=\"[]\"\n                    borderless\n                  />\n                </template>\n                <!-- 树形列表 - 父级节点 ED -->\n              </t-radio-group>\n              <template v-else>\n                <!-- 树形列表 - 叶子节点 ST -->\n                <template v-if=\"!multiple\">\n                  <!-- 树形列表 - 叶子节点（单选） ST -->\n                  <t-radio-group\n                    :value=\"convertTreeRadioType(treeState.selectList[level])\"\n                    @update:value=\"selectTreeNode(level, $event)\"\n                  >\n                    <template v-for=\"option in treeOptions[level]\" :key=\"option.value\">\n                      <t-radio\n                        :value=\"option.value\"\n                        :label=\"option.title\"\n                        :disabled=\"option.disabled\"\n                        :class=\"styleTreeRadio(option.value, level)\"\n                        align=\"right\"\n                        borderless\n                      />\n                    </template>\n                  </t-radio-group>\n                  <!-- 树形列表 - 叶子节点（单选） ED -->\n                </template>\n                <template v-else>\n                  <!-- 树形列表 - 叶子节点（多选） ST -->\n                  <t-checkbox-group\n                    :value=\"convertTreeCheckType(treeState.selectList[level])\"\n                    @update:value=\"selectTreeNode(level, $event)\"\n                  >\n                    <template v-for=\"option in treeOptions[level]\" :key=\"option.value\">\n                      <t-checkbox\n                        :value=\"option.value\"\n                        :label=\"option.title\"\n                        :disabled=\"option.disabled\"\n                        align=\"right\"\n                        borderless\n                      ></t-checkbox>\n                    </template>\n                  </t-checkbox-group>\n                  <!-- 树形列表 - 叶子节点（多选） ED -->\n                </template>\n                <!-- 树形列表 - 叶子节点 ED -->\n              </template>\n            </div>\n            <!-- 树形列表 ED -->\n          </template>\n        </slot>\n      </div>\n      <div v-if=\"multiple || optionsLayout === 'tree'\" :class=\"`${name}__ft`\">\n        <t-button variant=\"outline\" :disabled=\"isBtnDisabled\" @click=\"resetSelect\">重置</t-button>\n        <t-button theme=\"primary\" :disabled=\"isBtnDisabled\" @click=\"confirmSelect\">确定</t-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { CheckIcon } from 'tdesign-icons-vue-next';\nimport {\n  h,\n  ref,\n  watch,\n  toRefs,\n  inject,\n  computed,\n  reactive,\n  nextTick,\n  SetupContext,\n  onBeforeMount,\n  defineComponent,\n} from 'vue';\nimport { TNode } from '../common';\nimport TRadio from '../radio';\nimport config from '../config';\nimport TButton from '../button';\nimport TCheckbox, { CheckboxGroup as TCheckboxGroup } from '../checkbox';\nimport TRadioGroup from '../radio-group';\nimport TransAniControl from './trans-ani-control';\nimport { useVModel, useEmitEvent } from '../shared';\nimport DropdownItemProps from './dropdown-item-props';\nimport { DropdownMenuState, DropdownMenuControl } from './context';\nimport { TdDropdownMenuProps, TdDropdownItemProps, TdDropdownItemOption, TdDropdownItemOptionValueType } from './type';\n\nconst { prefix } = config;\nconst name = `${prefix}-dropdown-item`;\n\ninterface TdDropdownTreeState {\n  /**\n   * 叶子层级\n   */\n  leafLevel: number;\n  /**\n   * 树的各级选项\n   */\n  selectList: TdDropdownTreeValueType[];\n}\n\n/**\n * 树选中项目（单选/多选）\n */\ntype TdDropdownTreeValueType = TdDropdownItemOptionValueType | TdDropdownItemOptionValueType[] | undefined;\n\nexport default defineComponent({\n  name,\n  components: { TRadio, TButton, TCheckbox, TRadioGroup, TCheckboxGroup },\n  props: DropdownItemProps,\n  emits: ['change', 'open', 'opened', 'close', 'closed', 'update:value', 'update:modelValue'],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    // 受控 value 属性\n    const { value, modelValue } = toRefs(props);\n    const [passInValue, setValue] = useVModel(value, modelValue, props.defaultValue, props.onChange);\n    // 从父组件取属性、状态和控制函数\n    const menuProps = inject('dropdownMenuProps') as TdDropdownMenuProps;\n    const menuState = inject('dropdownMenuState') as DropdownMenuState;\n    const { expandMenu, collapseMenu } = inject('dropdownMenuControl') as DropdownMenuControl;\n    const menuAniControl = inject('dropdownAniControl') as TransAniControl;\n\n    // 组件样式\n    const classes = computed(() => [\n      `${name}`,\n      {\n        [`${prefix}-is-expanded`]: state.isExpanded,\n      },\n    ]);\n\n    const itemId = ref(0);\n    onBeforeMount(() => {\n      itemId.value = menuState.childCount;\n      menuState.childCount += 1;\n    });\n\n    const state = reactive({\n      showOverlay: computed(() => menuProps.overlay),\n      isShowItems: false,\n      isExpanded: false,\n      expandStyle: {},\n      transitionStyle: computed(() => ({\n        transition: `transform ${menuProps.duration}ms ease`,\n        '-webkit-transition': `transform ${menuProps.duration}ms ease`,\n      })),\n      multiple: computed(() => props.multiple),\n      optionsLayout: computed(() => props.optionsLayout),\n      options: computed(() => props.options),\n    });\n    const isCheckedRadio = (value: TdDropdownItemOptionValueType) => value === radioSelect.value;\n    const styleDropRadio = (value: TdDropdownItemOptionValueType) => [\n      `${name}__radio`,\n      {\n        [`${prefix}-is-tick`]: !props.multiple,\n        [`${prefix}-is-checked`]: isCheckedRadio(value),\n      },\n    ];\n    const styleContent = computed(() => {\n      const { optionsLayout } = props;\n      const layoutCol = +(props.optionsColumns ?? 0);\n      const isTree = optionsLayout === 'tree';\n      const treeCol = isTree ? treeState.leafLevel + 1 : 0;\n      return [\n        `${name}__content`,\n        {\n          [`${prefix}-is-tree`]: isTree,\n          [`${prefix}-is-single`]: !isTree && !props.multiple,\n          [`${prefix}-is-multi`]: !isTree && props.multiple,\n          [`${prefix}-is-col1`]: layoutCol === 1 || treeCol === 1,\n          [`${prefix}-is-col2`]: layoutCol === 2 || treeCol === 2,\n          [`${prefix}-is-col3`]: layoutCol === 3 || treeCol === 3,\n        },\n      ];\n    });\n    // 设置展开/收起状态\n    const setExpand = (val: boolean) => {\n      // 菜单定位\n      const { bottom } = menuState.barRect;\n      state.expandStyle = {\n        zIndex: menuProps.zIndex,\n        top: `${bottom}px`,\n      };\n      // console.log(`dropdown-item(${itemId.value}) changing state: `, val);\n      const { duration } = menuProps;\n      // 动画状态控制\n      menuAniControl.setTo(\n        +(duration ?? 200),\n        () => {\n          // Now do:\n          emitEvent(val ? 'open' : 'close');\n          if (val) {\n            state.isShowItems = val;\n          }\n          state.isExpanded = !val;\n        },\n        () => {\n          // Next tick do:\n          state.isExpanded = val;\n        },\n        () => {\n          // Finally do:\n          if (!val) {\n            state.isShowItems = val;\n          }\n          emitEvent(val ? 'opened' : 'closed');\n        },\n      );\n    };\n\n    // 根据父组件状态，判断当前是否展开\n    watch(\n      () => menuState.activeId === itemId.value,\n      (val: boolean) => setExpand(val),\n    );\n\n    const radioSelect = ref<TdDropdownItemOptionValueType | undefined>();\n    const checkSelect = ref<TdDropdownItemOptionValueType[]>([]);\n    const treeState = reactive<TdDropdownTreeState>({\n      leafLevel: 0,\n      selectList: [],\n    });\n    const styleTreeRadio = computed(() => (value: string, level: number) => [\n      `${name}__radio`,\n      {\n        [`${prefix}-is-tick`]: level === treeState.leafLevel,\n        [`${prefix}-is-checked`]: value === treeState.selectList[level],\n      },\n    ]);\n    // 点击树形节点的时候\n    const selectTreeNode = (level: number, value: TdDropdownTreeValueType, rebuildTree = true) => {\n      // console.log('level:', level, 'value:', value);\n      // 当前节点\n      const tempValue: TdDropdownTreeValueType[] = treeState.selectList.slice(0, level);\n      tempValue[level] = value;\n      treeState.selectList = tempValue;\n      if (rebuildTree) {\n        buildTreeOptions();\n      }\n    };\n    // 处理后的树形选项列表\n    const treeOptions = ref<TdDropdownItemOption[]>([]);\n    const buildTreeOptions = () => {\n      const { options } = props;\n      const { selectList } = treeState;\n      const newTreeOptions = [];\n      let level = -1;\n      let node: TdDropdownItemOption | undefined = {\n        title: '',\n        value: '',\n        disabled: false,\n        options,\n      };\n      while (node?.options) {\n        // 当前层级节点的列表\n        const list: TdDropdownItemOption[] = node.options;\n        newTreeOptions.push([...list]);\n        level += 1;\n        // 当前层级列表选中项\n        const thisValue: TdDropdownTreeValueType | undefined = selectList[level];\n        if (thisValue === undefined) {\n          const firstChild = list[0];\n          if (firstChild.options) {\n            // 还有子节点，当前层级作为单选处理\n            selectTreeNode(level, firstChild.value, false);\n            node = firstChild;\n          } else {\n            // 没有子节点，结束处理\n            selectTreeNode(level, props.multiple ? [] : undefined, false);\n            break;\n          }\n        } else if (!Array.isArray(thisValue)) {\n          const child: TdDropdownItemOption | undefined = list.find(\n            (child: TdDropdownItemOption) => child.value === thisValue,\n          );\n          node = child;\n        } else {\n          node = undefined;\n        }\n      }\n      treeState.leafLevel = Math.max(0, level);\n      treeOptions.value = newTreeOptions as [];\n    };\n    if (props.optionsLayout === 'tree') {\n      watch(\n        () =>\n          JSON.stringify({\n            options: props.options,\n          }),\n        async () => {\n          // fix: 这次微任务结束后，再重建选项。否则 oldVal 无法更新，导致无限调用\n          await nextTick();\n          buildTreeOptions();\n        },\n      );\n      buildTreeOptions();\n    }\n    // 根据传入值更新当前选中\n    const updateSelectValue = (\n      val: TdDropdownItemOptionValueType | TdDropdownItemOptionValueType[] | TdDropdownTreeValueType[] | null,\n    ) => {\n      const layout = props.optionsLayout;\n      if (layout === 'tree') {\n        treeState.selectList = (val ?? []) as TdDropdownTreeValueType[];\n        buildTreeOptions();\n      } else if (layout === 'columns') {\n        if (!props.multiple) {\n          const list = props.options as TdDropdownItemOption[];\n          const firstChild = list?.[0];\n          const newValue = val ?? firstChild?.value ?? null;\n          radioSelect.value = newValue as TdDropdownItemOptionValueType;\n        } else if (props.multiple) {\n          if (props.optionsLayout === 'columns') {\n            checkSelect.value = (val ?? []) as TdDropdownItemOptionValueType[];\n          }\n        }\n      }\n    };\n    // 初始值更新一次选中项\n    updateSelectValue(passInValue.value || null);\n    // 跟踪 modelValue 更新选项\n    watch(\n      () => passInValue.value,\n      (val) => {\n        if (!val) return;\n        updateSelectValue(val);\n      },\n    );\n    // 底部按键是否可用\n    const isBtnDisabled = computed(() => {\n      switch (props.optionsLayout) {\n        case 'columns':\n          return checkSelect.value.length <= 0;\n        case 'tree':\n          if (!props.multiple) {\n            return treeState.selectList[treeState.leafLevel] === undefined;\n          }\n          if (props.multiple) {\n            const selectList = treeState.selectList[treeState.leafLevel] as [];\n            return selectList && selectList.length <= 0;\n          }\n      }\n      return true;\n    });\n    // 重置\n    const resetSelect = () => {\n      switch (props.optionsLayout) {\n        case 'columns':\n          checkSelect.value = [];\n          break;\n        case 'tree':\n          treeState.selectList = [];\n          break;\n      }\n    };\n    // 确认\n    const confirmSelect = () => {\n      let values;\n      switch (props.optionsLayout) {\n        case 'columns':\n          values = checkSelect.value;\n          break;\n        case 'tree':\n          values = treeState.selectList;\n          break;\n      }\n      values = JSON.parse(JSON.stringify(values));\n      setValue(values);\n      collapseMenu();\n    };\n    // 单选值监控\n    watch(radioSelect, (val) => {\n      if (props.multiple || props.optionsLayout === 'tree') return;\n      if (!state.isShowItems) return;\n      const value = passInValue.value || [];\n      if (value[0] === val) return;\n      if (val) {\n        setValue(val);\n      }\n      collapseMenu();\n    });\n    // 点击遮罩层\n    const onClickOverlay = () => {\n      if (menuProps.closeOnClickOverlay) {\n        collapseMenu();\n      }\n    };\n    // 创建小图标\n    const TiconCheckIcon = h(CheckIcon);\n    // 树形节点的类型转换\n    const convertTreeRadioType = (value: TdDropdownTreeValueType) => value as TdDropdownItemOptionValueType;\n    const convertTreeCheckType = (value: TdDropdownTreeValueType) => value as TdDropdownItemOptionValueType[];\n    return {\n      name: ref(name),\n      ...toRefs(props),\n      ...toRefs(state),\n      classes,\n      styleContent,\n      isBtnDisabled,\n      radioSelect,\n      checkSelect,\n      treeOptions,\n      treeState,\n      styleTreeRadio,\n      isCheckedRadio,\n      selectTreeNode,\n      styleDropRadio,\n      expandMenu,\n      collapseMenu,\n      resetSelect,\n      confirmSelect,\n      onClickOverlay,\n      renderCheckIcon: [TiconCheckIcon as unknown as TNode],\n      convertTreeRadioType,\n      convertTreeCheckType,\n    };\n  },\n});\n</script>\n","<template>\n  <div v-if=\"isShowItems\" :class=\"classes\" :style=\"{ ...expandStyle }\">\n    <!-- <t-overlay v-if=\"isShowItems && showOverlay\" @click=\"onClickOverlay\" /> -->\n    <div :class=\"styleContent\" :style=\"{ ...transitionStyle }\">\n      <div :class=\"`${name}__bd`\">\n        <slot>\n          <template v-if=\"optionsLayout === 'columns'\">\n            <template v-if=\"!multiple\">\n              <!-- 单选列表 -->\n              <t-radio-group v-model=\"radioSelect\">\n                <template v-for=\"option in options\" :key=\"option.value\">\n                  <t-radio\n                    :value=\"option.value\"\n                    :label=\"option.title\"\n                    :disabled=\"option.disabled\"\n                    :class=\"styleDropRadio(option.value)\"\n                    align=\"right\"\n                    :checked=\"isCheckedRadio(option.value)\"\n                    :icon=\"renderCheckIcon\"\n                  />\n                </template>\n              </t-radio-group>\n            </template>\n            <template v-else>\n              <!-- 多选列表 -->\n              <t-checkbox-group v-model=\"checkSelect\">\n                <template v-for=\"option in options\" :key=\"option.value\">\n                  <t-checkbox borderless :value=\"option.value\" :label=\"option.title\" :disabled=\"option.disabled\" />\n                </template>\n              </t-checkbox-group>\n            </template>\n          </template>\n          <template v-else-if=\"optionsLayout === 'tree'\">\n            <!-- 树形列表 ST -->\n            <div v-for=\"(_, level) in treeOptions\" :key=\"level\" :class=\"`${name}__tree-group`\">\n              <t-radio-group\n                v-if=\"level < treeState.leafLevel\"\n                :model-value=\"convertTreeRadioType(treeState.selectList[level])\"\n                @update:model-value=\"selectTreeNode(level, $event)\"\n              >\n                <!-- 树形列表 - 父级节点 ST -->\n                <template v-for=\"option in treeOptions[level]\" :key=\"option.value\">\n                  <t-radio\n                    :class=\"styleTreeRadio(option.value, level)\"\n                    :value=\"option.value\"\n                    :label=\"option.title\"\n                    :disabled=\"option.disabled\"\n                    align=\"right\"\n                    :icon=\"[]\"\n                    borderless\n                  />\n                </template>\n                <!-- 树形列表 - 父级节点 ED -->\n              </t-radio-group>\n              <template v-else>\n                <!-- 树形列表 - 叶子节点 ST -->\n                <template v-if=\"!multiple\">\n                  <!-- 树形列表 - 叶子节点（单选） ST -->\n                  <t-radio-group\n                    :value=\"convertTreeRadioType(treeState.selectList[level])\"\n                    @update:value=\"selectTreeNode(level, $event)\"\n                  >\n                    <template v-for=\"option in treeOptions[level]\" :key=\"option.value\">\n                      <t-radio\n                        :value=\"option.value\"\n                        :label=\"option.title\"\n                        :disabled=\"option.disabled\"\n                        :class=\"styleTreeRadio(option.value, level)\"\n                        align=\"right\"\n                        borderless\n                      />\n                    </template>\n                  </t-radio-group>\n                  <!-- 树形列表 - 叶子节点（单选） ED -->\n                </template>\n                <template v-else>\n                  <!-- 树形列表 - 叶子节点（多选） ST -->\n                  <t-checkbox-group\n                    :value=\"convertTreeCheckType(treeState.selectList[level])\"\n                    @update:value=\"selectTreeNode(level, $event)\"\n                  >\n                    <template v-for=\"option in treeOptions[level]\" :key=\"option.value\">\n                      <t-checkbox\n                        :value=\"option.value\"\n                        :label=\"option.title\"\n                        :disabled=\"option.disabled\"\n                        align=\"right\"\n                        borderless\n                      ></t-checkbox>\n                    </template>\n                  </t-checkbox-group>\n                  <!-- 树形列表 - 叶子节点（多选） ED -->\n                </template>\n                <!-- 树形列表 - 叶子节点 ED -->\n              </template>\n            </div>\n            <!-- 树形列表 ED -->\n          </template>\n        </slot>\n      </div>\n      <div v-if=\"multiple || optionsLayout === 'tree'\" :class=\"`${name}__ft`\">\n        <t-button variant=\"outline\" :disabled=\"isBtnDisabled\" @click=\"resetSelect\">重置</t-button>\n        <t-button theme=\"primary\" :disabled=\"isBtnDisabled\" @click=\"confirmSelect\">确定</t-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { CheckIcon } from 'tdesign-icons-vue-next';\nimport {\n  h,\n  ref,\n  watch,\n  toRefs,\n  inject,\n  computed,\n  reactive,\n  nextTick,\n  SetupContext,\n  onBeforeMount,\n  defineComponent,\n} from 'vue';\nimport { TNode } from '../common';\nimport TRadio from '../radio';\nimport config from '../config';\nimport TButton from '../button';\nimport TCheckbox, { CheckboxGroup as TCheckboxGroup } from '../checkbox';\nimport TRadioGroup from '../radio-group';\nimport TransAniControl from './trans-ani-control';\nimport { useVModel, useEmitEvent } from '../shared';\nimport DropdownItemProps from './dropdown-item-props';\nimport { DropdownMenuState, DropdownMenuControl } from './context';\nimport { TdDropdownMenuProps, TdDropdownItemProps, TdDropdownItemOption, TdDropdownItemOptionValueType } from './type';\n\nconst { prefix } = config;\nconst name = `${prefix}-dropdown-item`;\n\ninterface TdDropdownTreeState {\n  /**\n   * 叶子层级\n   */\n  leafLevel: number;\n  /**\n   * 树的各级选项\n   */\n  selectList: TdDropdownTreeValueType[];\n}\n\n/**\n * 树选中项目（单选/多选）\n */\ntype TdDropdownTreeValueType = TdDropdownItemOptionValueType | TdDropdownItemOptionValueType[] | undefined;\n\nexport default defineComponent({\n  name,\n  components: { TRadio, TButton, TCheckbox, TRadioGroup, TCheckboxGroup },\n  props: DropdownItemProps,\n  emits: ['change', 'open', 'opened', 'close', 'closed', 'update:value', 'update:modelValue'],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    // 受控 value 属性\n    const { value, modelValue } = toRefs(props);\n    const [passInValue, setValue] = useVModel(value, modelValue, props.defaultValue, props.onChange);\n    // 从父组件取属性、状态和控制函数\n    const menuProps = inject('dropdownMenuProps') as TdDropdownMenuProps;\n    const menuState = inject('dropdownMenuState') as DropdownMenuState;\n    const { expandMenu, collapseMenu } = inject('dropdownMenuControl') as DropdownMenuControl;\n    const menuAniControl = inject('dropdownAniControl') as TransAniControl;\n\n    // 组件样式\n    const classes = computed(() => [\n      `${name}`,\n      {\n        [`${prefix}-is-expanded`]: state.isExpanded,\n      },\n    ]);\n\n    const itemId = ref(0);\n    onBeforeMount(() => {\n      itemId.value = menuState.childCount;\n      menuState.childCount += 1;\n    });\n\n    const state = reactive({\n      showOverlay: computed(() => menuProps.overlay),\n      isShowItems: false,\n      isExpanded: false,\n      expandStyle: {},\n      transitionStyle: computed(() => ({\n        transition: `transform ${menuProps.duration}ms ease`,\n        '-webkit-transition': `transform ${menuProps.duration}ms ease`,\n      })),\n      multiple: computed(() => props.multiple),\n      optionsLayout: computed(() => props.optionsLayout),\n      options: computed(() => props.options),\n    });\n    const isCheckedRadio = (value: TdDropdownItemOptionValueType) => value === radioSelect.value;\n    const styleDropRadio = (value: TdDropdownItemOptionValueType) => [\n      `${name}__radio`,\n      {\n        [`${prefix}-is-tick`]: !props.multiple,\n        [`${prefix}-is-checked`]: isCheckedRadio(value),\n      },\n    ];\n    const styleContent = computed(() => {\n      const { optionsLayout } = props;\n      const layoutCol = +(props.optionsColumns ?? 0);\n      const isTree = optionsLayout === 'tree';\n      const treeCol = isTree ? treeState.leafLevel + 1 : 0;\n      return [\n        `${name}__content`,\n        {\n          [`${prefix}-is-tree`]: isTree,\n          [`${prefix}-is-single`]: !isTree && !props.multiple,\n          [`${prefix}-is-multi`]: !isTree && props.multiple,\n          [`${prefix}-is-col1`]: layoutCol === 1 || treeCol === 1,\n          [`${prefix}-is-col2`]: layoutCol === 2 || treeCol === 2,\n          [`${prefix}-is-col3`]: layoutCol === 3 || treeCol === 3,\n        },\n      ];\n    });\n    // 设置展开/收起状态\n    const setExpand = (val: boolean) => {\n      // 菜单定位\n      const { bottom } = menuState.barRect;\n      state.expandStyle = {\n        zIndex: menuProps.zIndex,\n        top: `${bottom}px`,\n      };\n      // console.log(`dropdown-item(${itemId.value}) changing state: `, val);\n      const { duration } = menuProps;\n      // 动画状态控制\n      menuAniControl.setTo(\n        +(duration ?? 200),\n        () => {\n          // Now do:\n          emitEvent(val ? 'open' : 'close');\n          if (val) {\n            state.isShowItems = val;\n          }\n          state.isExpanded = !val;\n        },\n        () => {\n          // Next tick do:\n          state.isExpanded = val;\n        },\n        () => {\n          // Finally do:\n          if (!val) {\n            state.isShowItems = val;\n          }\n          emitEvent(val ? 'opened' : 'closed');\n        },\n      );\n    };\n\n    // 根据父组件状态，判断当前是否展开\n    watch(\n      () => menuState.activeId === itemId.value,\n      (val: boolean) => setExpand(val),\n    );\n\n    const radioSelect = ref<TdDropdownItemOptionValueType | undefined>();\n    const checkSelect = ref<TdDropdownItemOptionValueType[]>([]);\n    const treeState = reactive<TdDropdownTreeState>({\n      leafLevel: 0,\n      selectList: [],\n    });\n    const styleTreeRadio = computed(() => (value: string, level: number) => [\n      `${name}__radio`,\n      {\n        [`${prefix}-is-tick`]: level === treeState.leafLevel,\n        [`${prefix}-is-checked`]: value === treeState.selectList[level],\n      },\n    ]);\n    // 点击树形节点的时候\n    const selectTreeNode = (level: number, value: TdDropdownTreeValueType, rebuildTree = true) => {\n      // console.log('level:', level, 'value:', value);\n      // 当前节点\n      const tempValue: TdDropdownTreeValueType[] = treeState.selectList.slice(0, level);\n      tempValue[level] = value;\n      treeState.selectList = tempValue;\n      if (rebuildTree) {\n        buildTreeOptions();\n      }\n    };\n    // 处理后的树形选项列表\n    const treeOptions = ref<TdDropdownItemOption[]>([]);\n    const buildTreeOptions = () => {\n      const { options } = props;\n      const { selectList } = treeState;\n      const newTreeOptions = [];\n      let level = -1;\n      let node: TdDropdownItemOption | undefined = {\n        title: '',\n        value: '',\n        disabled: false,\n        options,\n      };\n      while (node?.options) {\n        // 当前层级节点的列表\n        const list: TdDropdownItemOption[] = node.options;\n        newTreeOptions.push([...list]);\n        level += 1;\n        // 当前层级列表选中项\n        const thisValue: TdDropdownTreeValueType | undefined = selectList[level];\n        if (thisValue === undefined) {\n          const firstChild = list[0];\n          if (firstChild.options) {\n            // 还有子节点，当前层级作为单选处理\n            selectTreeNode(level, firstChild.value, false);\n            node = firstChild;\n          } else {\n            // 没有子节点，结束处理\n            selectTreeNode(level, props.multiple ? [] : undefined, false);\n            break;\n          }\n        } else if (!Array.isArray(thisValue)) {\n          const child: TdDropdownItemOption | undefined = list.find(\n            (child: TdDropdownItemOption) => child.value === thisValue,\n          );\n          node = child;\n        } else {\n          node = undefined;\n        }\n      }\n      treeState.leafLevel = Math.max(0, level);\n      treeOptions.value = newTreeOptions as [];\n    };\n    if (props.optionsLayout === 'tree') {\n      watch(\n        () =>\n          JSON.stringify({\n            options: props.options,\n          }),\n        async () => {\n          // fix: 这次微任务结束后，再重建选项。否则 oldVal 无法更新，导致无限调用\n          await nextTick();\n          buildTreeOptions();\n        },\n      );\n      buildTreeOptions();\n    }\n    // 根据传入值更新当前选中\n    const updateSelectValue = (\n      val: TdDropdownItemOptionValueType | TdDropdownItemOptionValueType[] | TdDropdownTreeValueType[] | null,\n    ) => {\n      const layout = props.optionsLayout;\n      if (layout === 'tree') {\n        treeState.selectList = (val ?? []) as TdDropdownTreeValueType[];\n        buildTreeOptions();\n      } else if (layout === 'columns') {\n        if (!props.multiple) {\n          const list = props.options as TdDropdownItemOption[];\n          const firstChild = list?.[0];\n          const newValue = val ?? firstChild?.value ?? null;\n          radioSelect.value = newValue as TdDropdownItemOptionValueType;\n        } else if (props.multiple) {\n          if (props.optionsLayout === 'columns') {\n            checkSelect.value = (val ?? []) as TdDropdownItemOptionValueType[];\n          }\n        }\n      }\n    };\n    // 初始值更新一次选中项\n    updateSelectValue(passInValue.value || null);\n    // 跟踪 modelValue 更新选项\n    watch(\n      () => passInValue.value,\n      (val) => {\n        if (!val) return;\n        updateSelectValue(val);\n      },\n    );\n    // 底部按键是否可用\n    const isBtnDisabled = computed(() => {\n      switch (props.optionsLayout) {\n        case 'columns':\n          return checkSelect.value.length <= 0;\n        case 'tree':\n          if (!props.multiple) {\n            return treeState.selectList[treeState.leafLevel] === undefined;\n          }\n          if (props.multiple) {\n            const selectList = treeState.selectList[treeState.leafLevel] as [];\n            return selectList && selectList.length <= 0;\n          }\n      }\n      return true;\n    });\n    // 重置\n    const resetSelect = () => {\n      switch (props.optionsLayout) {\n        case 'columns':\n          checkSelect.value = [];\n          break;\n        case 'tree':\n          treeState.selectList = [];\n          break;\n      }\n    };\n    // 确认\n    const confirmSelect = () => {\n      let values;\n      switch (props.optionsLayout) {\n        case 'columns':\n          values = checkSelect.value;\n          break;\n        case 'tree':\n          values = treeState.selectList;\n          break;\n      }\n      values = JSON.parse(JSON.stringify(values));\n      setValue(values);\n      collapseMenu();\n    };\n    // 单选值监控\n    watch(radioSelect, (val) => {\n      if (props.multiple || props.optionsLayout === 'tree') return;\n      if (!state.isShowItems) return;\n      const value = passInValue.value || [];\n      if (value[0] === val) return;\n      if (val) {\n        setValue(val);\n      }\n      collapseMenu();\n    });\n    // 点击遮罩层\n    const onClickOverlay = () => {\n      if (menuProps.closeOnClickOverlay) {\n        collapseMenu();\n      }\n    };\n    // 创建小图标\n    const TiconCheckIcon = h(CheckIcon);\n    // 树形节点的类型转换\n    const convertTreeRadioType = (value: TdDropdownTreeValueType) => value as TdDropdownItemOptionValueType;\n    const convertTreeCheckType = (value: TdDropdownTreeValueType) => value as TdDropdownItemOptionValueType[];\n    return {\n      name: ref(name),\n      ...toRefs(props),\n      ...toRefs(state),\n      classes,\n      styleContent,\n      isBtnDisabled,\n      radioSelect,\n      checkSelect,\n      treeOptions,\n      treeState,\n      styleTreeRadio,\n      isCheckedRadio,\n      selectTreeNode,\n      styleDropRadio,\n      expandMenu,\n      collapseMenu,\n      resetSelect,\n      confirmSelect,\n      onClickOverlay,\n      renderCheckIcon: [TiconCheckIcon as unknown as TNode],\n      convertTreeRadioType,\n      convertTreeCheckType,\n    };\n  },\n});\n</script>\n"],"names":["prefix","config","name","defineComponent","components","TRadio","TButton","TCheckbox","TRadioGroup","TCheckboxGroup","props","DropdownItemProps","emits","setup","context","emitEvent","useEmitEvent","emit","toRefs","value","modelValue","useVModel","defaultValue","onChange","passInValue","setValue","menuProps","inject","menuState","expandMenu","collapseMenu","menuAniControl","classes","computed","state","isExpanded","itemId","ref","onBeforeMount","childCount","reactive","showOverlay","overlay","isShowItems","expandStyle","transitionStyle","transition","duration","multiple","optionsLayout","options","isCheckedRadio","radioSelect","styleDropRadio","styleContent","layoutCol","optionsColumns","isTree","treeCol","treeState","leafLevel","setExpand","val","bottom","barRect","zIndex","top","setTo","watch","activeId","checkSelect","selectList","styleTreeRadio","level","selectTreeNode","rebuildTree","tempValue","slice","buildTreeOptions","treeOptions","newTreeOptions","node","title","disabled","list","push","thisValue","firstChild","Array","isArray","child","find","Math","max","JSON","stringify","nextTick","updateSelectValue","layout","newValue","isBtnDisabled","length","resetSelect","confirmSelect","values","parse","onClickOverlay","closeOnClickOverlay","TiconCheckIcon","h","CheckIcon","convertTreeRadioType","convertTreeCheckType","_objectSpread","renderCheckIcon","_ctx","_createElementBlock","class","style","_createElementVNode","_renderSlot","_Fragment","key","_createBlock","_component_t_radio_group","$event","_renderList","option","_component_t_radio","label","_normalizeClass","align","checked","icon","_component_t_checkbox_group","_component_t_checkbox","borderless","_openBlock","_","_createVNode","_component_t_button","variant","onClick","theme"],"mappings":"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"}