{"version":3,"file":"index.js","sources":["../../src/toast/index.ts"],"sourcesContent":["import { createApp, App, DefineComponent } from 'vue';\nimport vueToast from './toast.vue';\nimport { TdToastProps } from './type';\nimport { WithInstallType } from '../shared';\n\nimport './style';\n\nexport * from './type';\nexport type ToastProps = TdToastProps;\n\nlet instance: any = null;\nlet app: App<Element>;\n\n/** 展示提示 */\nfunction Toast(props: string | Partial<TdToastProps>): DefineComponent<TdToastProps> {\n  const root = document.createElement('div');\n  document.body.appendChild(root);\n\n  const propsObject = {\n    duration: 2000,\n    ...parseOptions(props),\n  };\n\n  if (instance) {\n    instance.clear();\n  }\n\n  instance = vueToast;\n\n  instance.clear = () => {\n    clearTimeout(instance.timer);\n    app.unmount();\n    root.remove();\n  };\n\n  if (propsObject.duration && propsObject.duration > 0) {\n    instance.timer = setTimeout(instance.clear, propsObject.duration);\n  }\n\n  app = createApp(instance, { ...propsObject });\n  app.mount(root);\n\n  return instance;\n}\n\nToast.clear = () => {\n  if (instance) {\n    instance.clear();\n  }\n};\n\n(['loading', 'success', 'fail'] as TdToastProps['theme'][]).forEach((type): void => {\n  if (!type) {\n    return;\n  }\n  Toast[type] = (options: TdToastProps | string) => {\n    let props = { message: '', theme: type } as unknown as TdToastProps;\n\n    if (typeof options === 'string') {\n      props.message = options;\n    } else {\n      props = { ...props, ...options };\n    }\n\n    return Toast(props);\n  };\n});\n\nfunction parseOptions(message?: Partial<TdToastProps> | string) {\n  if (typeof message === 'string') {\n    return { message };\n  }\n  return message;\n}\n\nToast.install = (app: App) => {\n  // 添加插件入口\n  // eslint-disable-next-line no-param-reassign\n  app.config.globalProperties.$toast = Toast;\n};\n\ntype ToastApi = {\n  /** 展示提示 */\n  (options?: Partial<TdToastProps> | string): void;\n  /** 展示加载提示 */\n  loading: (options?: Partial<TdToastProps> | string) => void;\n  /** 展示成功提示 */\n  success: (options?: Partial<TdToastProps> | string) => void;\n  /** 展示失败提示 */\n  fail: (options?: Partial<TdToastProps> | string) => void;\n  /** 关闭提示 */\n  clear: () => void;\n};\n\nexport const ToastPlugin: WithInstallType<typeof vueToast> & ToastApi = Toast as any;\nexport default ToastPlugin;\n\ndeclare module '@vue/runtime-core' {\n  // Bind to `this` keyword\n  export interface ComponentCustomProperties {\n    $toast: ToastApi;\n  }\n}\n"],"names":["instance","app","Toast","props","root","document","createElement","body","appendChild","propsObject","duration","parseOptions","clear","vueToast","clearTimeout","timer","unmount","remove","setTimeout","createApp","mount","forEach","type","options","message","theme","install","config","globalProperties","$toast","ToastPlugin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUA,IAAIA,QAAgB,GAAA,IAAA,CAAA;AACpB,IAAIC,GAAA,CAAA;AAGJ,SAASC,MAAMC,KAAsE,EAAA;AAC7E,EAAA,IAAAC,IAAA,GAAOC,QAAS,CAAAC,aAAA,CAAc,KAAK,CAAA,CAAA;AAChCD,EAAAA,QAAA,CAAAE,IAAA,CAAKC,YAAYJ,IAAI,CAAA,CAAA;AAE9B,EAAA,IAAMK,WAAc,GAAA,aAAA,CAAA;AAClBC,IAAAA,QAAU,EAAA,GAAA;AAAA,GAAA,EACPC,aAAaR,KAAK,CAAA,CACvB,CAAA;AAEA,EAAA,IAAIH,QAAU,EAAA;IACZA,QAAA,CAASY,KAAM,EAAA,CAAA;AACjB,GAAA;AAEWZ,EAAAA,QAAA,GAAAa,MAAA,CAAA;EAEXb,QAAA,CAASY,QAAQ,YAAM;AACrBE,IAAAA,YAAA,CAAad,SAASe,KAAK,CAAA,CAAA;IAC3Bd,GAAA,CAAIe,OAAQ,EAAA,CAAA;IACZZ,IAAA,CAAKa,MAAO,EAAA,CAAA;GACd,CAAA;EAEA,IAAIR,WAAY,CAAAC,QAAA,IAAYD,WAAY,CAAAC,QAAA,GAAW,CAAG,EAAA;AACpDV,IAAAA,QAAA,CAASe,KAAQ,GAAAG,UAAA,CAAWlB,QAAS,CAAAY,KAAA,EAAOH,YAAYC,QAAQ,CAAA,CAAA;AAClE,GAAA;AAEAT,EAAAA,GAAA,GAAMkB,SAAU,CAAAnB,QAAA,EAAA,aAAA,CAAA,EAAA,EAAeS,YAAa,CAAA,CAAA;AAC5CR,EAAAA,GAAA,CAAImB,MAAMhB,IAAI,CAAA,CAAA;AAEP,EAAA,OAAAJ,QAAA,CAAA;AACT,CAAA;AAEAE,KAAA,CAAMU,QAAQ,YAAM;AAClB,EAAA,IAAIZ,QAAU,EAAA;IACZA,QAAA,CAASY,KAAM,EAAA,CAAA;AACjB,GAAA;AACF,CAAA,CAAA;AAEC,CAAC,WAAW,SAAW,EAAA,MAAM,CAA8B,CAAAS,OAAA,CAAQ,UAACC,IAAe,EAAA;EAClF,IAAI,CAACA,IAAM,EAAA;AACT,IAAA,OAAA;AACF,GAAA;AACMpB,EAAAA,KAAA,CAAAoB,IAAA,CAAA,GAAQ,UAACC,OAAmC,EAAA;AAChD,IAAA,IAAIpB,KAAQ,GAAA;AAAEqB,MAAAA,OAAS,EAAA,EAAA;AAAIC,MAAAA,OAAOH,IAAAA;KAAK,CAAA;AAEnC,IAAA,IAAA,OAAOC,YAAY,QAAU,EAAA;MAC/BpB,KAAA,CAAMqB,OAAU,GAAAD,OAAA,CAAA;AAClB,KAAO,MAAA;AACLpB,MAAAA,KAAA,GAAaA,aAAAA,CAAAA,aAAAA,CAAAA,EAAAA,EAAAA,KAAO,CAAGoB,EAAAA,OAAQ,CAAA,CAAA;AACjC,KAAA;IAEA,OAAOrB,MAAMC,KAAK,CAAA,CAAA;GACpB,CAAA;AACF,CAAC,CAAA,CAAA;AAED,SAASQ,aAAaa,OAA0C,EAAA;AAC1D,EAAA,IAAA,OAAOA,YAAY,QAAU,EAAA;IAC/B,OAAO;AAAEA,MAAAA,OAAQ,EAARA,OAAAA;KAAQ,CAAA;AACnB,GAAA;AACO,EAAA,OAAAA,OAAA,CAAA;AACT,CAAA;AAEAtB,KAAM,CAAAwB,OAAA,GAAU,UAACzB,IAAa,EAAA;AAG5BA,EAAAA,IAAAA,CAAI0B,MAAO,CAAAC,gBAAA,CAAiBC,MAAS,GAAA3B,KAAA,CAAA;AACvC,CAAA,CAAA;AAeO,IAAM4B,WAA2D,GAAA5B;;;;"}