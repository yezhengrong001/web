{"version":3,"file":"util.js","sources":["../../src/collapse/util.ts"],"sourcesContent":["/**\n * @description: 判断集合是否包含指定内容\n * @return 是否包含 | 位置索引\n */\nexport function findIndex(v: unknown, set: unknown): number {\n  // 正则方式，辨别0='0'\n  const reg = new RegExp(`^${!v && v !== 0 ? '' : v}$`);\n\n  // 转数组统一处理\n  const arr = toArray(set);\n  return arr.findIndex((s) => reg.test(s));\n}\n\n/**\n * @description: 判断是否假植 undefined|null|''等\n */\nexport function isFalsy(v: unknown): boolean {\n  return !v && v !== 0;\n}\n\n/**\n * @description: 转化为数组\n */\nexport function toArray(v: unknown): any[] {\n  if (isFalsy(v)) return [];\n  if (typeof v === 'object') return Array.from(v as Iterable<unknown> | ArrayLike<unknown>);\n  return [v];\n}\n\n/**\n * @description: 切换数组元素\n */\nexport function toggleElem(\n  v: string | number, // 要切换的元素\n  set: unknown, // 集合\n  multiple: boolean, // 是否多选\n  atLeastOne = false, // 是否保留一个\n): any[] | string | number {\n  // 判断是否要返回数组。 多选 | 集合为 array/proxy等需要\n  const toReturnArray: boolean = !!multiple || (!!set && typeof set === 'object');\n\n  // 预设 集合按原类型(多选除外)返回\n  const returnFn = (v: any[]) => (!toReturnArray ? v[0] : v);\n\n  // 统一数组处理(可监听的数组Proxy类，也支持数组操作)\n  const arr: any[] = toArray(set);\n  const arrLen: number = arr.length;\n\n  // 元素所在索引\n  const i = findIndex(v, arr);\n\n  // 元素存在\n  if (i > -1) {\n    // 限制保留一个，且只剩下最后一个\n    if (arrLen < 2 && atLeastOne) {\n      return returnFn(arr);\n    }\n    // 移除该元素\n    arr.splice(i, 1);\n    return returnFn(arr);\n  }\n\n  // 不存在，增加 / 替换\n  if (!multiple && arrLen > 0) {\n    // 替换: 不支持多选，且已有1个\n    return returnFn([v]);\n  }\n\n  // 增加\n  arr.push(v);\n  return returnFn(arr);\n}\n"],"names":["findIndex","v","set","reg","RegExp","arr","toArray","s","test","isFalsy","Array","from","toggleElem","multiple","atLeastOne","toReturnArray","returnFn","arrLen","length","i","splice","push"],"mappings":";;;;;;;;AAIgB,SAAAA,SAAA,CAAUC,GAAYC,GAAsB,EAAA;AAEpD,EAAA,IAAAC,GAAA,GAAM,IAAIC,MAAO,YAAI,CAACH,CAAK,IAAAA,CAAA,KAAM,CAAI,GAAA,EAAA,GAAKA,CAAI,EAAA,GAAA,CAAA,CAAA,CAAA;AAG9C,EAAA,IAAAI,GAAA,GAAMC,QAAQJ,GAAG,CAAA,CAAA;AACvB,EAAA,OAAOG,IAAIL,SAAU,CAAA,UAACO;WAAMJ,GAAI,CAAAK,IAAA,CAAKD,CAAC,CAAC,CAAA;GAAA,CAAA,CAAA;AACzC,CAAA;AAKO,SAASE,QAAQR,CAAqB,EAAA;AACpC,EAAA,OAAA,CAACA,KAAKA,CAAM,KAAA,CAAA,CAAA;AACrB,CAAA;AAKO,SAASK,QAAQL,CAAmB,EAAA;AACzC,EAAA,IAAIQ,QAAQR,CAAC,CAAA,EAAG,OAAO,EAAC,CAAA;EACxB,IAAI,OAAA,CAAOA,CAAM,CAAA,KAAA,QAAA,EAAiB,OAAAS,KAAA,CAAMC,KAAKV,CAA2C,CAAA,CAAA;EACxF,OAAO,CAACA,CAAC,CAAA,CAAA;AACX,CAAA;AAKO,SAASW,UACd,CAAAX,CAAA,EACAC,GACA,EAAAW,QAAA,EAEyB;EAAA,IADzBC,iFAAa,KACY,CAAA;AAEnB,EAAA,IAAAC,aAAA,GAAyB,CAAC,CAACF,QAAA,IAAa,CAAC,CAACX,GAAA,IAAO,OAAOA,CAAAA,GAAQ,MAAA,QAAA,CAAA;AAGtE,EAAA,IAAMc,WAAW,SAAXA,SAAYf,EAAAA,EAAAA;IAAAA,OAAc,CAACc,aAAA,GAAgBd,GAAE,CAAKA,CAAAA,GAAAA,EAAAA,CAAAA;AAAAA,GAAAA,CAAAA;AAGlD,EAAA,IAAAI,GAAA,GAAaC,QAAQJ,GAAG,CAAA,CAAA;AAC9B,EAAA,IAAMe,SAAiBZ,GAAI,CAAAa,MAAA,CAAA;AAGrB,EAAA,IAAAC,CAAA,GAAInB,SAAU,CAAAC,CAAA,EAAGI,GAAG,CAAA,CAAA;AAG1B,EAAA,IAAIc,IAAI,CAAI,CAAA,EAAA;AAEN,IAAA,IAAAF,MAAA,GAAS,KAAKH,UAAY,EAAA;MAC5B,OAAOE,SAASX,GAAG,CAAA,CAAA;AACrB,KAAA;AAEIA,IAAAA,GAAA,CAAAe,MAAA,CAAOD,GAAG,CAAC,CAAA,CAAA;IACf,OAAOH,SAASX,GAAG,CAAA,CAAA;AACrB,GAAA;AAGI,EAAA,IAAA,CAACQ,QAAY,IAAAI,MAAA,GAAS,CAAG,EAAA;AAEpB,IAAA,OAAAD,QAAA,CAAS,CAACf,CAAC,CAAC,CAAA,CAAA;AACrB,GAAA;AAGAI,EAAAA,GAAA,CAAIgB,KAAKpB,CAAC,CAAA,CAAA;EACV,OAAOe,SAASX,GAAG,CAAA,CAAA;AACrB;;;;"}