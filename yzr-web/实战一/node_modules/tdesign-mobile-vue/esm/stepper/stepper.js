/**
 * tdesign v0.12.1
 * (c) 2022 TDesign Group
 * @license MIT
 */

import _defineProperty from '@babel/runtime/helpers/defineProperty';
import _slicedToArray from '@babel/runtime/helpers/slicedToArray';
import { defineComponent, toRefs, computed, resolveComponent, openBlock, createElementBlock, normalizeClass, createElementVNode, createVNode, withDirectives, normalizeStyle, vModelText } from 'vue';
import { AddIcon, RemoveIcon } from 'tdesign-icons-vue-next';
import config from '../config.js';
import StepperProps from './props.js';
import ClASSNAMES from '../shared/constants.js';
import '../shared/index.js';
import { useDefault } from '../shared/useDefault/index.js';
import { useEmitEvent } from '../shared/useEmitEvent/index.js';
import '../shared/functions.js';
import '../shared/util.js';
import '../shared/component.js';
import '../shared/render.js';
import '@babel/runtime/helpers/typeof';
import 'lodash/camelCase';
import '../shared/render-tnode.js';
import '../shared/useToggle/index.js';
import '../shared/useCountDown/index.js';
import '@babel/runtime/helpers/asyncToGenerator';
import '@babel/runtime/regenerator';
import '@vueuse/core';
import '../shared/useCountDown/utils.js';
import '../shared/useChildSlots/index.js';
import '@babel/runtime/helpers/toConsumableArray';
import '../shared/useVModel/index.js';
import '../shared/useTouch/index.js';
import '../shared/useScrollParent/index.js';
import '../shared/useExpose/index.js';

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }
function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }
var prefix = config.prefix;
var name = "".concat(prefix, "-stepper");
var disabledClass = ClASSNAMES.STATUS.disabled;
var script = defineComponent({
  name: name,
  components: {
    AddIcon: AddIcon,
    RemoveIcon: RemoveIcon
  },
  props: StepperProps,
  emits: ["update:value", "update:modelValue", "blur", "change", "overlimit"],
  setup: function setup(props, context) {
    var _useDefault = useDefault(props, context.emit, "value", "change"),
      _useDefault2 = _slicedToArray(_useDefault, 1),
      stepperValue = _useDefault2[0];
    var emitEvent = useEmitEvent(props, context.emit);
    var _toRefs = toRefs(props),
      min = _toRefs.min,
      max = _toRefs.max,
      step = _toRefs.step,
      inputWidth = _toRefs.inputWidth,
      theme = _toRefs.theme,
      disabled = _toRefs.disabled;
    var isPureMode = computed(function () {
      return theme.value === "grey";
    });
    var inputStyle = computed(function () {
      return inputWidth ? {
        width: "".concat(inputWidth.value, "px")
      } : "";
    });
    var isDisabled = function isDisabled(type) {
      if (disabled.value) return true;
      if (type === "minus" && stepperValue.value <= min.value) {
        return true;
      }
      if (type === "plus" && stepperValue.value >= max.value) {
        return true;
      }
      return false;
    };
    var formatValue = function formatValue(value) {
      return Math.max(Math.min(max.value, value, Number.MAX_SAFE_INTEGER), min.value, Number.MIN_SAFE_INTEGER);
    };
    var updateValue = function updateValue(value) {
      stepperValue.value = formatValue(value);
    };
    var plusValue = function plusValue() {
      if (isDisabled("plus")) {
        emitEvent("overlimit", "plus");
        return;
      }
      updateValue(Number(stepperValue.value) + step.value);
    };
    var minusValue = function minusValue() {
      if (isDisabled("minus")) {
        emitEvent("overlimit", "minus");
        return;
      }
      updateValue(Number(stepperValue.value) - step.value);
    };
    var handleInput = function handleInput(e) {
      handleChange(e);
    };
    var handleChange = function handleChange(e) {
      var value = e.target.value.match(/^\d+\.\d+|^\d+/g);
      if (isNaN(Number(value))) return;
      var formattedValue = formatValue(Number(value));
      updateValue(Number(formattedValue));
    };
    var handleBlur = function handleBlur(e) {
      handleChange(e);
      emitEvent("blur", stepperValue.value);
    };
    return _objectSpread({
      name: name,
      disabledClass: disabledClass,
      minusValue: minusValue,
      stepperValue: stepperValue,
      plusValue: plusValue,
      handleInput: handleInput,
      handleChange: handleChange,
      inputStyle: inputStyle,
      handleBlur: handleBlur,
      isPureMode: isPureMode
    }, toRefs(props));
  }
});

var _hoisted_1 = ["disabled", "readonly"];
function render(_ctx, _cache, $props, $setup, $data, $options) {
  var _component_remove_icon = resolveComponent("remove-icon");
  var _component_add_icon = resolveComponent("add-icon");
  return openBlock(), createElementBlock("div", {
    class: normalizeClass(["".concat(_ctx.name), "".concat(_ctx.disabled ? _ctx.disabledClass : ""), "".concat(_ctx.isPureMode ? "".concat(_ctx.name, "__pure") : "")])
  }, [createElementVNode("div", {
    class: normalizeClass(["".concat(_ctx.name, "__minus"), "".concat(_ctx.disabled || _ctx.stepperValue <= _ctx.min ? "t-is-disabled" : "")]),
    onClick: _cache[0] || (_cache[0] = function () {
      return _ctx.minusValue && _ctx.minusValue.apply(_ctx, arguments);
    })
  }, [createVNode(_component_remove_icon, {
    class: normalizeClass("".concat(_ctx.name, "__icon"))
  }, null, 8, ["class"])], 2), withDirectives(createElementVNode("input", {
    "onUpdate:modelValue": _cache[1] || (_cache[1] = function ($event) {
      return _ctx.stepperValue = $event;
    }),
    class: normalizeClass("".concat(_ctx.name, "__input")),
    type: "tel",
    style: normalizeStyle(_ctx.inputStyle),
    disabled: _ctx.disableInput || _ctx.disabled,
    readonly: _ctx.disableInput,
    onBlur: _cache[2] || (_cache[2] = function () {
      return _ctx.handleBlur && _ctx.handleBlur.apply(_ctx, arguments);
    }),
    onInput: _cache[3] || (_cache[3] = function () {
      return _ctx.handleInput && _ctx.handleInput.apply(_ctx, arguments);
    })
  }, null, 46, _hoisted_1), [[vModelText, _ctx.stepperValue]]), createElementVNode("div", {
    class: normalizeClass(["".concat(_ctx.name, "__plus"), "".concat(_ctx.disabled || _ctx.stepperValue >= _ctx.max ? "t-is-disabled" : "")]),
    onClick: _cache[4] || (_cache[4] = function () {
      return _ctx.plusValue && _ctx.plusValue.apply(_ctx, arguments);
    })
  }, [createVNode(_component_add_icon, {
    class: normalizeClass("".concat(_ctx.name, "__icon"))
  }, null, 8, ["class"])], 2)], 2);
}

script.render = render;

export { script as default };
//# sourceMappingURL=stepper.js.map
